<!-- umap.html -->
{% extends 'base.html' %}

{% block right_section %}
    <h2>UMAP Plots</h2>
    
    <!-- 사용자 파일로 생성된 UMAP -->
    <h3>Your UMAP Plot</h3>
    {% if user_umap_plot %}
        <img src="/{{ user_umap_plot }}" alt="User UMAP Plot">
    {% else %}
        <p>No UMAP plot from your uploaded file. Please upload a file to generate UMAP.</p>
    {% endif %}
    
    <hr>

    <!-- S3 및 PanglaoDB 파일 선택 섹션 -->
    <h3>Select a File from S3 or PanglaoDB</h3>
    <form method="POST">
        {% csrf_token %}
        <label for="s3_file">Choose a file:</label>
        <select id="s3_file" name="s3_file" required>
            <option value="" disabled selected>Select a file</option>
            {% for folder, display_name in s3_files %}
            <option value="{{ folder }}">{{ display_name }}</option>
            {% endfor %}
        </select>
        <br><br>
        <label for="delimiter">Choose delimiter:</label>
        <select id="delimiter" name="delimiter">
            <option value=",">Comma (,)</option>
            <option value="\t">Tab (\t)</option>
        </select>
        <br><br>
        <input type="submit" value="Generate UMAP">
    </form>
    <div style="display: flex; align-items: flex-start;">
    <!-- 생성된 UMAP 및 관련 데이터 -->
    <h3>UMAP Plot</h3>
    {% if s3_umap_plot %}
        <img src="/{{ s3_umap_plot }}" alt="S3 UMAP Plot">
    {% elif panglao_umap_plot %}
        <img src="/{{ panglao_umap_plot }}" alt="PanglaoDB UMAP Plot">
    {% else %}
        <p>No UMAP plot from selected file. Please select a file to generate UMAP.</p>
    {% endif %}

    <!-- UNS 데이터 표시 -->
        <!-- UNS Data -->
        <div style="width: 30%; margin-left: 20px;">
            <h3>UNS Data</h3>
            {% if uns_data %}
                <ul>
                {% for key, value in uns_data.items %}
                    <li><strong>{{ key }}:</strong> {{ value }}</li>
                {% endfor %}
                </ul>
            {% else %}
                <p>No UNS data available.</p>
            {% endif %}
        </div>
    </div>
{% endblock %}

